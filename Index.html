<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mindfull - Your Mental Wellness Sanctuary</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #f0f7ff, #e6f0fa);
            color: #2d3748;
            padding: 0;
            min-height: 100vh;
        }
        body.logged-in {
            background: #ffffff;
        }
        header {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            height: 100px;
            z-index: 200;
        }
        .logo {
            width: 80px;
            height: 80px;
            margin-right: 20px;
            filter: drop-shadow(0 0 10px rgba(246, 224, 94, 0.5));
        }
        .header-content {
            text-align: center;
        }
        .header-content h1 {
            font-size: 2.8em;
            color: #1a4971;
            margin-bottom: 5px;
        }
        .header-content p {
            font-size: 1.2em;
            color: #4a5568;
        }
        .nav-bar {
            background: #1a4971;
            padding: 15px 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 100px;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .nav-bar ul {
            list-style: none;
            display: flex;
            gap: 20px;
        }
        .nav-bar a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            font-size: 1.1em;
            transition: color 0.3s;
        }
        .nav-bar a:hover {
            color: #63b3ed;
        }
        .nav-auth {
            display: flex;
            gap: 10px;
        }
        .nav-auth button {
            padding: 8px 16px;
            font-size: 0.9em;
            border-radius: 20px;
            background: linear-gradient(to right, #3182ce, #63b3ed);
            transition: background 0.3s, transform 0.2s;
        }
        .nav-auth button:hover {
            background: linear-gradient(to right, #2b6cb0, #4299e1);
            transform: scale(1.01);
        }
        .welcome {
            display: none;
            text-align: center;
            padding: 15px;
            background: #007e4d;
            color: white;
            border-radius: 8px;
            margin: 20px auto;
            max-width: 1200px;
            font-size: 1.2em;
            animation: fadeIn 0.5s ease-in;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        .container.logged-in {
            max-width: 900px;
            margin-left: 270px;
        }
        .section {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            transition: box-shadow 0.3s;
            scroll-margin-top: 160px;
        }
        .section.hidden {
            display: none;
        }
        .section:hover {
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
        }
        .section h2 {
            color: #0052cc;
            font-size: 1.5em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }
        .section h2::before {
            content: '';
            display: inline-block;
            width: 24px;
            height: 24px;
            background-size: cover;
        }
        .ai-insights h2::before { background-image: url('https://img.icons8.com/color/24/artificial-intelligence.png'); }
        .resources h2::before { background-image: url('https://img.icons8.com/color/24/library.png'); }
        .exercises h2::before { background-image: url('https://img.icons8.com/color/24/meditation.png'); }
        .crisis h2::before { background-image: url('https://img.icons8.com/color/24/emergency-exit.png'); }
        input, select, button {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        input:focus, select:focus {
            outline: none;
            border-color: #0052cc;
            box-shadow: 0 0 6px rgba(0, 82, 204, 0.3);
        }
        button {
            background: linear-gradient(to right, #0052cc, #007e4d);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s, transform 0.2s;
        }
        button:hover {
            background: linear-gradient(to right, #003d99, #005f3a);
            transform: scale(1.01);
        }
        button:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
            transform: none;
        }
        .mood-list, .resource-list, .exercise-list {
            max-height: 250px;
            overflow-y: auto;
            padding: 10px;
            background: #f7fafc;
            border-radius: 8px;
            margin-top: 10px;
        }
        .mood-entry, .resource-item, .exercise-item {
            padding: 8px;
            border-bottom: 1px solid #edf2f7;
            font-size: 0.9em;
        }
        .mood-entry span:last-child {
            color: #718096;
            font-size: 0.8em;
        }
        .resource-item a, .exercise-item a {
            color: #0052cc;
            text-decoration: none;
            font-weight: 500;
        }
        .resource-item a:hover, .exercise-item a:hover {
            color: #003d99;
        }
        .insight {
            background: #f7fafc;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 10px;
            font-size: 0.9em;
        }
        .error, .success {
            font-size: 0.9em;
            margin: 8px 0;
            padding: 8px;
            border-radius: 6px;
        }
        .error { background: #fed7d7; color: #c53030; }
        .success { background: #c6f6d5; color: #2f855a; }
        .crisis a {
            color: #c53030;
            font-weight: 600;
            text-decoration: none;
        }
        .crisis a:hover {
            text-decoration: underline;
        }
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .modal.active {
            display: flex;
        }
        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 12px;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
            position: relative;
        }
        .modal-content h2 {
            color: #0052cc;
            font-size: 1.5em;
            margin-bottom: 15px;
        }
        .close-modal {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 1.5em;
            cursor: pointer;
            color: #718096;
        }
        .auth-form {
            display: none;
        }
        .auth-form.active {
            display: block;
        }
        /* Sidebar Styles */
        .sidebar {
            display: none;
            position: fixed;
            top: 160px;
            left: 0;
            width: 250px;
            max-height: 80vh;
            background: #ffffff;
            padding: 20px;
            box-shadow: 2px 0 4px rgba(0, 0, 0, 0.1);
            border-right: 2px solid transparent;
            border-image: linear-gradient(to bottom, #0052cc, #007e4d) 1;
            overflow-y: auto;
            z-index: 50;
        }
        .sidebar.active {
            display: block;
        }
        .sidebar h3 {
            color: #0052cc;
            font-size: 1.2em;
            margin-bottom: 10px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: color 0.3s;
        }
        .sidebar h3:hover {
            color: #003d99;
        }
        .sidebar h3::after {
            content: '▼';
            font-size: 0.8em;
        }
        .sidebar h3.collapsed::after {
            content: '▶';
        }
        .sidebar-content {
            display: none;
            padding: 10px;
            background: #f7fafc;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        .sidebar-content.active {
            display: block;
        }
        /* MoodBuddy Styles */
        .moodbuddy-container {
            display: none;
            margin: 20px auto;
            max-width: 500px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
        }
        .moodbuddy-container.active {
            display: block;
        }
        .moodbuddy-header {
            background: #0052cc;
            color: white;
            padding: 10px;
            border-radius: 12px 12px 0 0;
            font-size: 1.2em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .moodbuddy-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
        }
        .moodbuddy-messages {
            height: 450px;
            padding: 10px;
            overflow-y: auto;
            background: #f7fafc;
        }
        .moodbuddy-typing {
            display: none;
            padding: 10px;
            color: #718096;
            font-size: 0.9em;
        }
        .moodbuddy-typing.active {
            display: block;
        }
        .moodbuddy-typing::after {
            content: '...';
            animation: typing 1s infinite;
        }
        .moodbuddy-input {
            display: flex;
            padding: 10px;
            background: #edf2f7;
            border-radius: 0 0 12px 12px;
        }
        .moodbuddy-input input {
            flex: 1;
            margin: 0;
            border-radius: 6px 0 0 6px;
        }
        .moodbuddy-input button {
            width: auto;
            padding: 12px 15px;
            border-radius: 0 6px 6px 0;
            margin: 0;
        }
        /* Hybrid Widget Styles */
        .hybrid-widget {
            display: none;
            position: fixed;
            top: 180px;
            right: 20px;
            width: 300px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
            z-index: 999;
            padding: 15px;
        }
        .hybrid-widget.active {
            display: block;
        }
        .hybrid-widget-header {
            background: #007e4d;
            color: white;
            padding: 10px;
            border-radius: 8px 8px 0 0;
            font-size: 1.1em;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .hybrid-widget-header .toggle-widget {
            cursor: pointer;
            font-size: 1.2em;
        }
        .hybrid-widget-content {
            padding: 10px;
        }
        .hybrid-widget-content button {
            margin-bottom: 10px;
            padding: 10px;
            font-size: 0.9em;
        }
        .hybrid-widget-content iframe {
            width: 100%;
            height: 200px;
            border: none;
            border-radius: 8px;
            margin-top: 10px;
        }
        .hybrid-widget-content a {
            display: block;
            color: #0052cc;
            text-decoration: none;
            padding: 8px;
            border-radius: 6px;
            transition: background 0.3s;
        }
        .hybrid-widget-content a:hover {
            background: #e6f0fa;
        }
        /* Chatbot Styles (Pre-Login) */
        .chatbot-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: #3182ce url('https://img.icons8.com/color/48/chat.png') no-repeat center;
            background-size: 32px;
            border-radius: 50%;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            z-index: 1000;
            transition: transform 0.3s;
        }
        .chatbot-toggle:hover {
            transform: scale(1.01);
        }
        .chatbot-window {
            display: none;
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 320px;
            height: 420px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
            z-index: 999;
            flex-direction: column;
            transition: transform 0.3s ease-in-out;
        }
        .chatbot-window.active {
            display: flex;
            transform: translateY(0);
        }
        .chatbot-header {
            background: #1a4971;
            color: white;
            padding: 10px;
            border-radius: 12px 12px 0 0;
            font-size: 1.1em;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .chatbot-header .close-chat {
            cursor: pointer;
            font-size: 1.2em;
        }
        .chatbot-messages {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
            background: #f7fafc;
        }
        .chat-typing {
            display: none;
            padding: 10px;
            color: #718096;
            font-size: 0.9em;
        }
        .chat-typing.active {
            display: block;
        }
        .chat-typing::after {
            content: '...';
            animation: typing 1s infinite;
        }
        .chatbot-input {
            display: flex;
            padding: 10px;
            background: #edf2f7;
            border-radius: 0 0 12px 12px;
        }
        .chatbot-input input {
            flex: 1;
            margin: 0;
            border-radius: 6px 0 0 6px;
        }
        .chatbot-input button {
            width: auto;
            padding: 12px 15px;
            border-radius: 0 6px 6px 0;
            margin: 0;
        }
        .chat-message {
            padding: 10px;
            margin: 5px;
            border-radius: 8px;
            font-size: 0.9em;
            line-height: 1.4;
        }
        .chat-message.user {
            background: #e6f0fa;
            text-align: right;
            border-radius: 8px 8px 0 8px;
            margin-left: 20%;
        }
        .chat-message.bot {
            background: #c6f6d5;
            border-radius: 8px 8px 8px 0;
            margin-right: 20%;
        }
        @keyframes typing {
            0% { content: '.'; }
            33% { content: '..'; }
            66% { content: '...'; }
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @media (max-width: 768px) {
            .nav-bar {
                flex-direction: column;
                gap: 10px;
            }
            .nav-bar ul {
                flex-direction: column;
                align-items: center;
            }
            .nav-auth {
                flex-direction: column;
                width: 100%;
            }
            .nav-auth button {
                width: 100%;
            }
            .header-content h1 { font-size: 2em; }
            .header-content p { font-size: 1em; }
            .container { padding: 0 10px; }
            .container.logged-in { margin-left: 0; }
            .chatbot-window, .moodbuddy-container, .hybrid-widget {
                width: 90%;
                right: 5%;
            }
            .modal-content {
                width: 95%;
            }
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
                top: 0;
            }
        }
    </style>
</head>
<body>
    <header>
        <svg class="logo" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <defs>
                <radialGradient id="glow" cx="50%" cy="50%" r="50%">
                    <stop offset="0%" style="stop-color:#f6e05e;stop-opacity:0.9"/>
                    <stop offset="100%" style="stop-color:#ed8936;stop-opacity:0.3"/>
                </radialGradient>
            </defs>
            <circle cx="50" cy="50" r="48" fill="url(#glow)"/>
            <path d="M50 30 C60 30 70 40 70 50 C70 60 60 70 50 70 C40 70 30 60 30 50 C30 40 40 30 50 30 Z M50 35 C57 35 63 41 63 50 C63 59 57 65 50 65 C43 65 37 59 37 50 C37 41 43 35 50 35 Z" fill="#ffffff"/>
            <path d="M50 25 C45 20 55 20 50 25 C60 20 70 30 70 40 C75 35 80 45 75 50 C80 55 75 65 70 70 C65 75 55 80 50 75 C45 80 35 75 30 70 C25 65 20 55 25 50 C20 45 25 35 30 40 C30 30 40 20 50 25 Z" fill="#ed8936" opacity="0.8"/>
            <path d="M45 45 C47 45 49 47 49 50 C49 53 47 55 45 55 C43 55 41 53 41 50 C41 47 43 45 45 45 Z M55 45 C57 45 59 47 59 50 C59 53 57 55 55 55 C53 55 51 53 51 50 C51 47 53 45 55 45 Z" fill="#f6e05e"/>
        </svg>
        <div class="header-content">
            <h1>Mindfull</h1>
            <p>Your sanctuary for mental wellness and self-discovery</p>
        </div>
    </header>
    <nav class="nav-bar">
        <ul>
            <li><a href="#home" onclick="showSection('home')">Home</a></li>
            <li><a href="#resources" onclick="showSection('resources')">Resources</a></li>
            <li><a href="#ai-insights" onclick="showSection('ai-insights')">Insights</a></li>
            <li><a href="#exercises" onclick="showSection('exercises')">Exercises</a></li>
            <li><a href="#crisis" onclick="showSection('crisis')">Help</a></li>
        </ul>
        <div class="nav-auth" id="nav-auth">
            <button onclick="showModal('register')">New User? Register</button>
            <button onclick="showModal('login')">Already Registered? Sign In</button>
        </div>
    </nav>
    <div class="welcome" id="welcome-message">Welcome back, <span id="username"></span>!</div>
    <div class="sidebar" id="sidebar">
        <h3 id="mood-track-toggle">Track Your Mood</h3>
        <div class="sidebar-content active" id="mood-track-content">
            <select id="mood-select">
                <option value="Great">Great 😄</option>
                <option value="Good">Good 🙂</option>
                <option value="Okay">Okay 😐</option>
                <option value="Sad">Sad 🙁</option>
                <option value="Bad">Bad 😢</option>
            </select>
            <input type="text" id="mood-notes" placeholder="What's on your mind?">
            <button id="mood-btn" onclick="saveMood()">Save Mood</button>
            <p class="error" id="mood-error"></p>
            <p class="success" id="mood-success"></p>
        </div>
        <h3 id="mood-history-toggle">Mood History</h3>
        <div class="sidebar-content" id="mood-history-content">
            <div class="mood-list" id="mood-list"></div>
            <p class="error" id="mood-list-error"></p>
        </div>
    </div>
    <div class="container" id="container">
        <div class="moodbuddy-container" id="moodbuddy-container">
            <div class="moodbuddy-header">
                <img src="https://img.icons8.com/color/48/doctor-male.png" class="moodbuddy-avatar" alt="MoodBuddy Avatar">
                MoodBuddy
            </div>
            <div class="moodbuddy-messages" id="moodbuddy-messages">
                <div class="chat-message bot">
                    <p>Hey, friend! 😊 I’m MoodBuddy, your wellness companion. I’m here to listen and support you like a trusted psychiatrist. How’s your heart feeling today? Share a bit, and let’s find some calm together! 🌈</p>
                </div>
            </div>
            <div class="moodbuddy-typing" id="moodbuddy-typing">MoodBuddy is typing</div>
            <div class="moodbuddy-input">
                <input type="text" id="moodbuddy-input" placeholder="Type your message..." onkeypress="if(event.key === 'Enter') sendMoodBuddyChat()">
                <button onclick="sendMoodBuddyChat()">Send</button>
            </div>
            <p style="font-size: 0.8em; color: #718096; padding: 5px; text-align: center;">
                MoodBuddy provides support but is not a replacement for professional mental health care.
            </p>
        </div>
        <!-- AI Insights Section -->
        <div class="section ai-insights" id="ai-insights">
            <h2>AI Insights</h2>
            <div class="insight">
                <strong>Based on your patterns</strong>
                <p>Journaling can boost your mood. Try reflecting on three things you're grateful for today. <a href="https://greatergood.berkeley.edu/article/item/why_gratitude_is_good" target="_blank">Read more about gratitude</a>.</p>
            </div>
            <div class="insight">
                <strong>Progress insight</strong>
                <p>Consistency in tracking moods improves self-awareness. Watch this <a href="https://www.youtube.com/watch?v=JD4O7ema3_Y" target="_blank">TED Talk on mindfulness</a> to stay motivated.</p>
            </div>
        </div>
        <!-- Resource Library Section -->
        <div class="section resources" id="resources">
            <h2>Resource Library</h2>
            <div class="resource-list">
                <div class="resource-item"><strong>Articles</strong>
                    <p><a href="https://www.nimh.nih.gov/health/topics/anxiety-disorders" target="_blank">Understanding Anxiety Disorders (NIMH)</a></p>
                    <p><a href="https://greatergood.berkeley.edu/article/item/how_to_sleep_better" target="_blank">How to Sleep Better</a></p>
                    <p><a href="https://www.psychologytoday.com/us/basics/mindfulness" target="_blank">Mindfulness Basics</a></p>
                </div>
                <div class="resource-item"><strong>Videos</strong>
                    <p><a href="https://www.youtube.com/watch?v=rqoxYKtEWEc" target="_blank">10-Minute Guided Meditation for Anxiety</a></p>
                    <p><a href="https://www.youtube.com/watch?v=6p_yaNFSYao" target="_blank">CBT Techniques for Beginners</a></p>
                    <p><a href="https://www.youtube.com/watch?v=ZToicYcHIOU" target="_blank">Breathing Exercises for Stress Relief</a></p>
                </div>
                <div class="resource-item"><strong>Podcasts</strong>
                    <p><a href="https://www.thementalhealthtoolbox.com/podcast/" target="_blank">The Mental Health Toolbox</a></p>
                    <p><a href="https://www.happierhuman.com/podcasts/" target="_blank">Happier Human Podcast</a></p>
                    <p><a href="https://www.sleepfoundation.org/podcast" target="_blank">Sleep Foundation Podcast</a></p>
                </div>
                <div class="resource-item"><strong>Self-Assessment</strong>
                    <p><a href="https://screening.mhanational.org/screening-tools/anxiety" target="_blank">Anxiety Screening Tool</a></p>
                    <p><a href="https://screening.mhanational.org/screening-tools/depression" target="_blank">Depression Screening Tool</a></p>
                    <p><a href="https://www.sleepfoundation.org/sleep-quizzes" target="_blank">Sleep Quality Quiz</a></p>
                </div>
            </div>
            <button onclick="window.open('https://www.nimh.nih.gov/health/topics', '_blank')">Browse All Resources</button>
        </div>
        <!-- Guided Exercises Section -->
        <div class="section exercises" id="exercises">
            <h2>Guided Exercises</h2>
            <div class="exercise-list">
                <div class="exercise-item">
                    <strong>5-Minute Breathing Exercise</strong>
                    <p>Quick stress relief technique</p>
                    <a href="https://www.youtube.com/watch?v=ZToicYcHIOU" target="_blank">Start Now</a>
                </div>
                <div class="exercise-item">
                    <strong>Progressive Muscle Relaxation</strong>
                    <p>15-minute guided session</p>
                    <a href="https://www.youtube.com/watch?v=1nZEdqcGVzo" target="_blank">Start Now</a>
                </div>
                <div class="exercise-item">
                    <strong>Mindful Body Scan</strong>
                    <p>10-minute guided meditation</p>
                    <a href="https://www.youtube.com/watch?v=zsNoM1y3T14" target="_blank">Start Now</a>
                </div>
                <div class="exercise-item">
                    <strong>Gratitude Practice</strong>
                    <p>5-minute guided reflection</p>
                    <a href="https://www.youtube.com/watch?v=2U6bH7lQ2WI" target="_blank">Start Now</a>
                </div>
            </div>
            <button onclick="window.open('https://www.youtube.com/results?search_query=guided+meditation', '_blank')">View All Exercises</button>
        </div>
        <!-- Need Immediate Help Section -->
        <div class="section crisis" id="crisis">
            <h2>Need Immediate Help?</h2>
            <p>If you're in crisis or need urgent support, please reach out to these resources:</p>
            <div class="resource-list">
                <div class="resource-item">
                    <strong>988 Suicide & Crisis Lifeline</strong>
                    <p><a href="tel:988">Call or text 988</a></p>
                </div>
                <div class="resource-item">
                    <strong>Crisis Text Line</strong>
                    <p><a href="sms:741741?&body=HOME">Text HOME to 741741</a></p>
                </div>
                <div class="resource-item">
                    <strong>Emergency Services</strong>
                    <p><a href="tel:911">Call 911 or go to nearest ER</a></p>
                </div>
            </div>
        </div>
    </div>
    <!-- Auth Modal -->
    <div class="modal" id="auth-modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">✕</span>
            <div class="auth-form" id="register-form">
                <h2>Register</h2>
                <input type="text" id="register-username" placeholder="Username">
                <input type="email" id="register-email" placeholder="Email">
                <input type="password" id="register-password" placeholder="Password">
                <button id="register-btn" onclick="register()">Register</button>
                <p class="error" id="register-error"></p>
                <p class="success" id="register-success"></p>
            </div>
            <div class="auth-form" id="login-form">
                <h2>Sign In</h2>
                <input type="email" id="login-email" placeholder="Email">
                <input type="password" id="login-password" placeholder="Password">
                <button id="login-btn" onclick="login()">Sign In</button>
                <p class="error" id="login-error"></p>
                <p class="success" id="login-success"></p>
            </div>
        </div>
    </div>
    <!-- MoodBot Widget (Pre-Login) -->
    <div class="chatbot-toggle" id="chatbot-toggle" onclick="toggleChatbot()"></div>
    <div class="chatbot-window" id="chatbot-window">
        <div class="chatbot-header">
            MoodBot
            <span class="close-chat" onclick="toggleChatbot()">✕</span>
        </div>
        <div class="chatbot-messages" id="chat-messages">
            <div class="chat-message bot">
                <p>Hey there! 😊 I’m MoodBot, your wellness buddy. How’s your day going? Share how you’re feeling, and I’ll suggest some ways to brighten your mood! 🌈</p>
            </div>
        </div>
        <div class="chat-typing" id="chat-typing">MoodBot is typing</div>
        <div class="chatbot-input">
            <input type="text" id="chat-input" placeholder="Type your message..." onkeypress="if(event.key === 'Enter') sendChat()">
            <button onclick="sendChat()">Send</button>
        </div>
        <p style="font-size: 0.8em; color: #718096; padding: 5px; text-align: center;">
            MoodBot provides support but is not a replacement for professional mental health care.
        </p>
    </div>
    <!-- Hybrid Widget -->
    <div class="hybrid-widget" id="hybrid-widget">
        <div class="hybrid-widget-header">
            Wellness Hub
            <span class="toggle-widget" onclick="toggleHybridWidget()">−</span>
        </div>
        <div class="hybrid-widget-content">
            <button onclick="window.open('https://www.apollohospitals.com/patient-care/appointment', '_blank')">Book Appointment with Doctor</button>
            <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3806.389139793623!2d78.38673261487636!3d17.44120558804382!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3bcb93e4c6aaaaaa%3A0x1b7f6a3e8c7b6f4!2sApollo%20Hospitals%2C%20Jubilee%20Hills!5e0!3m2!1sen!2sin!4v1634567890123" allowfullscreen></iframe>
            <strong>Media Streaming</strong>
            <a href="https://www.youtube.com/playlist?list=PL9ooVrP1hQOE4KoZLUP4LgBwFJ29tGje2" target="_blank">Guided Meditation Playlist</a>
            <a href="https://www.youtube.com/playlist?list=PLui6Eyny-UzwkUh_xJ2eYxJkz3Cq1kOan" target="_blank">Mental Health Talks</a>
        </div>
    </div>

    <script>
        let token = null;
        let isLoggedIn = false;
        let chatCount = 0;

        // Update UI based on login status
        function updateUI() {
            const welcome = document.getElementById('welcome-message');
            const usernameSpan = document.getElementById('username');
            const navAuth = document.getElementById('nav-auth');
            const container = document.getElementById('container');
            const sidebar = document.getElementById('sidebar');
            const chatbotToggle = document.getElementById('chatbot-toggle');
            const chatbotWindow = document.getElementById('chatbot-window');
            const moodbuddyContainer = document.getElementById('moodbuddy-container');
            const hybridWidget = document.getElementById('hybrid-widget');
            const sections = {
                'resources': document.getElementById('resources'),
                'ai-insights': document.getElementById('ai-insights'),
                'exercises': document.getElementById('exercises'),
                'crisis': document.getElementById('crisis')
            };

            if (isLoggedIn) {
                document.body.classList.add('logged-in');
                container.classList.add('logged-in');
                welcome.style.display = 'block';
                usernameSpan.textContent = localStorage.getItem('username') || 'User';
                navAuth.innerHTML = '<button onclick="logout()">Logout</button>';
                sidebar.classList.add('active');
                chatbotToggle.style.display = 'none';
                chatbotWindow.style.display = 'none';
                moodbuddyContainer.classList.add('active');
                hybridWidget.classList.add('active');
                Object.values(sections).forEach(section => section.classList.add('hidden'));
                getMoods();
            } else {
                document.body.classList.remove('logged-in');
                container.classList.remove('logged-in');
                welcome.style.display = 'none';
                navAuth.innerHTML = `
                    <button onclick="showModal('register')">New User? Register</button>
                    <button onclick="showModal('login')">Already Registered? Sign In</button>
                `;
                sidebar.classList.remove('active');
                chatbotToggle.style.display = 'block';
                moodbuddyContainer.classList.remove('active');
                hybridWidget.classList.remove('active');
                Object.values(sections).forEach(section => section.classList.remove('hidden'));
            }
        }

        // Show Section
        function showSection(sectionId) {
            const sections = {
                'home': document.getElementById('container'),
                'resources': document.getElementById('resources'),
                'ai-insights': document.getElementById('ai-insights'),
                'exercises': document.getElementById('exercises'),
                'crisis': document.getElementById('crisis')
            };
            Object.values(sections).forEach(section => section.classList.add('hidden'));
            if (sectionId !== 'home') {
                sections[sectionId].classList.remove('hidden');
                sections[sectionId].scrollIntoView({ behavior: 'smooth' });
            }
        }

        // Modal and Form Functions
        function showModal(formType) {
            const modal = document.getElementById('auth-modal');
            const registerForm = document.getElementById('register-form');
            const loginForm = document.getElementById('login-form');
            modal.classList.add('active');
            if (formType === 'register') {
                registerForm.classList.add('active');
                loginForm.classList.remove('active');
            } else {
                loginForm.classList.add('active');
                registerForm.classList.remove('active');
            }
        }

        function closeModal() {
            const modal = document.getElementById('auth-modal');
            modal.classList.remove('active');
            document.getElementById('register-form').classList.remove('active');
            document.getElementById('login-form').classList.remove('active');
        }

        // Register Function
        async function register() {
            const username = document.getElementById('register-username').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const errorEl = document.getElementById('register-error');
            const successEl = document.getElementById('register-success');

            errorEl.textContent = '';
            successEl.textContent = '';

            try {
                const response = await fetch('http://localhost:5000/api/auth/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, email, password })
                });
                const data = await response.json();
                if (response.ok) {
                    successEl.textContent = 'Registration successful! Please sign in.';
                    document.getElementById('register-username').value = '';
                    document.getElementById('register-email').value = '';
                    document.getElementById('register-password').value = '';
                    showModal('login');
                } else {
                    errorEl.textContent = data.error || 'Registration failed';
                }
            } catch (err) {
                errorEl.textContent = 'Error connecting to server';
            }
        }

        // Login Function
        async function login() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const errorEl = document.getElementById('login-error');
            const successEl = document.getElementById('login-success');

            errorEl.textContent = '';
            successEl.textContent = '';

            try {
                const response = await fetch('http://localhost:5000/api/auth/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });
                const data = await response.json();
                if (response.ok) {
                    token = data.token;
                    isLoggedIn = true;
                    localStorage.setItem('username', data.user.username);
                    successEl.textContent = 'Login successful!';
                    document.getElementById('login-email').value = '';
                    document.getElementById('login-password').value = '';
                    closeModal();
                    updateUI();
                } else {
                    errorEl.textContent = data.error || 'Login failed';
                }
            } catch (err) {
                errorEl.textContent = 'Error connecting to server';
            }
        }

        // Logout Function
        function logout() {
            token = null;
            isLoggedIn = false;
            localStorage.removeItem('username');
            chatCount = 0;
            updateUI();
        }

        // Save Mood Function
        async function saveMood() {
            const mood = document.getElementById('mood-select').value;
            const notes = document.getElementById('mood-notes').value;
            const errorEl = document.getElementById('mood-error');
            const successEl = document.getElementById('mood-success');

            errorEl.textContent = '';
            successEl.textContent = '';

            if (!isLoggedIn) {
                errorEl.textContent = 'Please log in to save a mood';
                return;
            }

            try {
                const response = await fetch('http://localhost:5000/api/moods', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({ mood, notes })
                });
                const data = await response.json();
                if (response.ok) {
                    successEl.textContent = 'Mood saved successfully!';
                    document.getElementById('mood-notes').value = '';
                    getMoods();
                } else {
                    errorEl.textContent = data.error || 'Failed to save mood';
                }
            } catch (err) {
                errorEl.textContent = 'Error connecting to server';
            }
        }

        // Get Moods Function
        async function getMoods() {
            const moodList = document.getElementById('mood-list');
            const errorEl = document.getElementById('mood-list-error');

            errorEl.textContent = '';

            if (!isLoggedIn) {
                errorEl.textContent = 'Please log in to view moods';
                return;
            }

            try {
                const response = await fetch('http://localhost:5000/api/moods', {
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                const data = await response.json();
                if (response.ok) {
                    moodList.innerHTML = '';
                    data.moods.forEach(mood => {
                        const div = document.createElement('div');
                        div.className = 'mood-entry';
                        div.innerHTML = `
                            <span>${mood.mood} - ${mood.notes || 'No notes'}</span>
                            <span>${new Date(mood.date).toLocaleString()}</span>
                        `;
                        moodList.appendChild(div);
                    });
                    if (data.moods.length === 0) {
                        moodList.innerHTML = '<p style="color: #718096;">No moods recorded yet.</p>';
                    }
                } else {
                    errorEl.textContent = 'Failed to load moods';
                }
            } catch (err) {
                errorEl.textContent = 'Error connecting to server';
            }
        }

        // Sidebar Toggle
        document.getElementById('mood-track-toggle').addEventListener('click', () => {
            const content = document.getElementById('mood-track-content');
            const toggle = document.getElementById('mood-track-toggle');
            content.classList.toggle('active');
            toggle.classList.toggle('collapsed');
        });
        document.getElementById('mood-history-toggle').addEventListener('click', () => {
            const content = document.getElementById('mood-history-content');
            const toggle = document.getElementById('mood-history-toggle');
            content.classList.toggle('active');
            toggle.classList.toggle('collapsed');
        });

        // MoodBot Functions (Pre-Login)
        function toggleChatbot() {
            const chatbotWindow = document.getElementById('chatbot-window');
            chatbotWindow.classList.toggle('active');
        }

        function sendChat() {
            const chatInput = document.getElementById('chat-input');
            const chatMessages = document.getElementById('chat-messages');
            const chatTyping = document.getElementById('chat-typing');
            const message = chatInput.value.trim();
            if (!message) return;

            // Add user message
            const userMessage = document.createElement('div');
            userMessage.className = 'chat-message user';
            userMessage.innerHTML = `<p>${message}</p>`;
            chatMessages.appendChild(userMessage);
            chatInput.value = '';
            chatCount++;

            // Show typing indicator
            chatTyping.classList.add('active');
            chatMessages.scrollTop = chatMessages.scrollHeight;

            // MoodBot response
            setTimeout(() => {
                chatTyping.classList.remove('active');
                const botMessage = document.createElement('div');
                botMessage.className = 'chat-message bot';
                let response = '';
                const responses = {
                    stress: [
                        'Oh, stress can feel like a heavy weight, can’t it? 😔 Let’s try something to ease it—check out the “5-Minute Breathing Exercise” in Exercises. Want to share what’s got you stressed? I’m all ears! 🌿',
                        'I hear you, stress is tough! 😓 The “Breathing Exercises for Stress Relief” video in Resources might help. Tell me more about what’s going on—any specific stress you want to unpack? 💪'
                    ],
                    sad: [
                        'I’m so sorry you’re feeling down, friend. 💙 Try the “Gratitude Practice” in Exercises to spark a little light. Want to talk about what’s making you sad? I’m here for you! 😊',
                        'Feeling sad is hard, I know. 😢 The “10-Minute Guided Meditation” video in Resources can be super soothing. Care to share what’s on your mind? Let’s work through it together! 🌟'
                    ],
                    happy: [
                        'Yay, your happiness is infectious! 🎉 Keep those vibes going with the “Mindful Body Scan” in Exercises. What’s got you so joyful today? Spill the beans! 😄',
                        'Love that you’re happy! 😊 The “Why Gratitude is Good” article in Resources can boost those good feels. What’s making your day amazing? Tell me more! 🌈'
                    ],
                    sleep: [
                        'Sleep troubles are the worst, right? 😴 Check out the “How to Sleep Better” article in Resources for some great tips. What’s keeping you up? Let’s figure it out! 🌙',
                        'Not sleeping well? 😪 The “Sleep Foundation Podcast” in Resources has awesome advice. Want to share what’s disrupting your sleep? I’m here to help! 😊'
                    ],
                    work: [
                        'Work can be a lot sometimes! 😅 The “CBT Techniques for Beginners” video in Resources can help manage work stress. What’s going on at work? Let’s talk it through! 💼',
                        'Work stress is real! 😓 Try the “5-Minute Breathing Exercise” in Exercises to reset. Care to share what’s tough at work? I’m listening! 🌿'
                    ],
                    anxiety: [
                        'Anxiety can feel so overwhelming—I’m here for you! 😔 The “10-Minute Guided Meditation for Anxiety” video in Resources might bring some calm. What’s sparking your anxiety? Let’s sort it out! 🌈',
                        'I know anxiety’s tough. 😢 Try the “Breathing Exercises for Stress Relief” video in Resources. Want to talk about what’s making you anxious? I’ve got your back! 💪'
                    ],
                    overwhelmed: [
                        'Feeling overwhelmed is exhausting, isn’t it? 😔 Let’s take it one step at a time—try the “Progressive Muscle Relaxation” in Exercises. What’s piling up on you? I’m here to listen! 🌿',
                        'I hear you, being overwhelmed is a lot! 😓 The “Mindful Body Scan” in Exercises can help you find some peace. Care to share what’s overwhelming you? Let’s tackle it together! 😊'
                    ],
                    tired: [
                        'Feeling tired can really weigh you down. 😴 The “How to Sleep Better” article in Resources has tips to recharge. What’s got you so exhausted? Let’s chat about it! 🌙',
                        'Ugh, tiredness is rough! 😪 Try the “5-Minute Breathing Exercise” in Exercises for a quick boost. Want to tell me what’s draining you? I’m all ears! 😊'
                    ],
                    default: [
                        'Hey, thanks for sharing! 😊 I’m here to help with stress, sadness, or just to chat. Want to try a resource from Exercises? Tell me how you’re feeling today! 🌿',
                        'Hi there, friend! 😄 I’m MoodBot, ready to brighten your day. Share what’s on your mind, and I’ll suggest some helpful resources! What’s up? 🌈'
                    ]
                };
                const lowerMessage = message.toLowerCase();
                if (lowerMessage.includes('stress') || lowerMessage.includes('stressed')) {
                    response = responses.stress[Math.floor(Math.random() * responses.stress.length)];
                } else if (lowerMessage.includes('sad') || lowerMessage.includes('depressed')) {
                    response = responses.sad[Math.floor(Math.random() * responses.sad.length)];
                } else if (lowerMessage.includes('happy') || lowerMessage.includes('good')) {
                    response = responses.happy[Math.floor(Math.random() * responses.happy.length)];
                } else if (lowerMessage.includes('sleep') || lowerMessage.includes('insomnia')) {
                    response = responses.sleep[Math.floor(Math.random() * responses.sleep.length)];
                } else if (lowerMessage.includes('work') || lowerMessage.includes('job')) {
                    response = responses.work[Math.floor(Math.random() * responses.work.length)];
                } else if (lowerMessage.includes('anxiety') || lowerMessage.includes('anxious')) {
                    response = responses.anxiety[Math.floor(Math.random() * responses.anxiety.length)];
                } else if (lowerMessage.includes('overwhelmed') || lowerMessage.includes('overloaded')) {
                    response = responses.overwhelmed[Math.floor(Math.random() * responses.overwhelmed.length)];
                } else if (lowerMessage.includes('tired') || lowerMessage.includes('exhausted')) {
                    response = responses.tired[Math.floor(Math.random() * responses.tired.length)];
                } else {
                    response = responses.default[Math.floor(Math.random() * responses.default.length)];
                }
                if (chatCount >= 4 && !isLoggedIn) {
                    response += ' Please login/register for Personalized Chats & Professional Help.';
                }
                botMessage.innerHTML = `<p>${response}</p>`;
                chatMessages.appendChild(botMessage);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }, 1500);
        }

        // MoodBuddy Functions (Post-Login)
        function sendMoodBuddyChat() {
            const chatInput = document.getElementById('moodbuddy-input');
            const chatMessages = document.getElementById('moodbuddy-messages');
            const chatTyping = document.getElementById('moodbuddy-typing');
            const message = chatInput.value.trim();
            if (!message) return;

            // Add user message
            const userMessage = document.createElement('div');
            userMessage.className = 'chat-message user';
            userMessage.innerHTML = `<p>${message}</p>`;
            chatMessages.appendChild(userMessage);
            chatInput.value = '';
            chatCount++;

            // Show typing indicator
            chatTyping.classList.add('active');
            chatMessages.scrollTop = chatMessages.scrollHeight;

            // MoodBuddy response
            setTimeout(() => {
                chatTyping.classList.remove('active');
                const botMessage = document.createElement('div');
                botMessage.className = 'chat-message bot';
                let response = '';
                const responses = {
                    stress: [
                        'I’m really sorry to hear you’re stressed, friend. 😔 Let’s try a grounding exercise: take 5 slow breaths, in for 4, out for 4. Want to check out the “5-Minute Breathing Exercise” in Exercises? Tell me more about what’s stressing you out—I’m here to listen! 🌿',
                        'Stress can feel like a storm, can’t it? 😓 I suggest the “CBT Techniques for Beginners” video in Resources to help you navigate it. What’s been piling up? Let’s unpack it together, step by step. 💪'
                    ],
                    sad: [
                        'Oh, friend, I’m so sorry you’re feeling sad. 💙 Let’s try something gentle—write down one thing you’re grateful for today. The “Gratitude Practice” in Exercises can guide you. Want to share what’s weighing on your heart? I’m right here for you. 😊',
                        'Feeling down is tough, and I’m here to support you. 😢 The “10-Minute Guided Meditation” in Resources might bring some calm. Can you tell me a bit more about what’s going on? Let’s find some light together! 🌟'
                    ],
                    happy: [
                        'Your happiness is lighting up my day, friend! 🎉 Let’s keep that joy flowing—try the “Mindful Body Scan” in Exercises to stay centered. What’s got you so happy? Spill the details, I love hearing this! 😄',
                        'Wow, I’m thrilled you’re feeling great! 😊 The “Why Gratitude is Good” article in Resources can amplify those good vibes. What’s making you smile today? Tell me all about it! 🌈'
                    ],
                    sleep: [
                        'Not sleeping well can be so draining, I get it. 😴 The “How to Sleep Better” article in Resources has practical tips to help you rest. What’s keeping you awake? Let’s figure out a plan to get you some Z’s! 🌙',
                        'Sleep struggles are rough, friend. 😪 I recommend the “Sleep Foundation Podcast” in Resources for some bedtime inspiration. Want to share what’s disrupting your sleep? I’m here to help you unwind! 😊'
                    ],
                    work: [
                        'Work can really take it out of you, huh? 😅 Let’s ease the pressure—try the “CBT Techniques for Beginners” video in Resources. What’s been tough at work? I’m all ears, let’s sort it out together! 💼',
                        'I hear you, work stress is a lot! 😓 The “5-Minute Breathing Exercise” in Exercises can be a quick reset. Care to share what’s going on at your job? I’ll listen and help you find some calm. 🌿'
                    ],
                    anxiety: [
                        'Anxiety can feel like a whirlwind, but I’m here to ground you, friend. 😔 Try the “10-Minute Guided Meditation for Anxiety” in Resources to find some peace. What’s sparking your anxiety? Let’s talk it through—I’ve got you! 🌈',
                        'I know how heavy anxiety can be. 😢 The “Breathing Exercises for Stress Relief” video in Resources might help you feel steadier. Want to share what’s making you anxious? I’m here to support you every step! 💪'
                    ],
                    overwhelmed: [
                        'Feeling overwhelmed is exhausting, friend—I’m here for you! 😔 Let’s take it slow—try the “Progressive Muscle Relaxation” in Exercises to unwind. What’s piling up? Share a bit, and we’ll sort it out together. 🌿',
                        'Oh, I feel you—being overwhelmed is a lot to carry! 😓 The “Mindful Body Scan” in Exercises can help you find calm. Want to tell me what’s overloading you? I’m listening, let’s lighten the load! 😊'
                    ],
                    tired: [
                        'Ugh, tiredness can make everything harder, can’t it? 😴 The “How to Sleep Better” article in Resources has tips to recharge your energy. What’s got you so tired? Let’s chat and find ways to lift you up! 🌙',
                        'Feeling exhausted is rough, friend. 😪 Try the “5-Minute Breathing Exercise” in Exercises for a quick energy boost. Care to share what’s draining you? I’m here to help you feel refreshed! 😊'
                    ],
                    default: [
                        'Hey, friend, it’s so good to hear from you! 😊 I’m here to listen and support you like a trusted pal. What’s on your mind today? Share a bit, and I’ll suggest some ways to brighten your day! 🌿',
                        'Hi there! 😄 I’m MoodBuddy, your wellness companion. I’m all about helping you feel your best, like a friend and psychiatrist in one. What’s going on with you? Let’s dive in and find some calm! 🌈'
                    ]
                };
                const lowerMessage = message.toLowerCase();
                if (lowerMessage.includes('stress') || lowerMessage.includes('stressed')) {
                    response = responses.stress[Math.floor(Math.random() * responses.stress.length)];
                } else if (lowerMessage.includes('sad') || lowerMessage.includes('depressed')) {
                    response = responses.sad[Math.floor(Math.random() * responses.sad.length)];
                } else if (lowerMessage.includes('happy') || lowerMessage.includes('good')) {
                    response = responses.happy[Math.floor(Math.random() * responses.happy.length)];
                } else if (lowerMessage.includes('sleep') || lowerMessage.includes('insomnia')) {
                    response = responses.sleep[Math.floor(Math.random() * responses.sleep.length)];
                } else if (lowerMessage.includes('work') || lowerMessage.includes('job')) {
                    response = responses.work[Math.floor(Math.random() * responses.work.length)];
                } else if (lowerMessage.includes('anxiety') || lowerMessage.includes('anxious')) {
                    response = responses.anxiety[Math.floor(Math.random() * responses.anxiety.length)];
                } else if (lowerMessage.includes('overwhelmed') || lowerMessage.includes('overloaded')) {
                    response = responses.overwhelmed[Math.floor(Math.random() * responses.overwhelmed.length)];
                } else if (lowerMessage.includes('tired') || lowerMessage.includes('exhausted')) {
                    response = responses.tired[Math.floor(Math.random() * responses.tired.length)];
                } else {
                    response = responses.default[Math.floor(Math.random() * responses.default.length)];
                }
                botMessage.innerHTML = `<p>${response}</p>`;
                chatMessages.appendChild(botMessage);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }, 1500);
        }

        // Hybrid Widget Toggle
        function toggleHybridWidget() {
            const widget = document.getElementById('hybrid-widget');
            const toggle = document.querySelector('.toggle-widget');
            widget.classList.toggle('collapsed');
            toggle.textContent = widget.classList.contains('collapsed') ? '+' : '−';
        }

        // Auto-open Chatbot/MoodBuddy
        window.onload = () => {
            setTimeout(() => {
                if (isLoggedIn) {
                    const moodbuddyContainer = document.getElementById('moodbuddy-container');
                    if (!moodbuddyContainer.classList.contains('active')) {
                        moodbuddyContainer.classList.add('active');
                    }
                } else {
                    const chatbotWindow = document.getElementById('chatbot-window');
                    if (!chatbotWindow.classList.contains('active')) {
                        toggleChatbot();
                    }
                }
            }, 3500);
            updateUI();
        };
    </script>
</body>
</html>
